---
schema: |+
  definition user {}

  definition group {
    relation direct_member: user
    relation intern: user
    relation allowed: user
    permission intern_but_not_allowed = intern - allowed
    permission non_intern_member = direct_member - intern_but_not_allowed
  }

  definition document {
    relation viewer: user | group#non_intern_member
    permission view = viewer
  }

relationships: |
  document:firstdoc#viewer@user:tom#...
  document:firstdoc#viewer@group:engineering#non_intern_member
  group:engineering#direct_member@user:sarah#...
  group:engineering#direct_member@user:fred#...
  group:engineering#direct_member@user:james#...
  group:engineering#direct_member@user:tom#...
  group:engineering#direct_member@user:jim#...
  group:engineering#direct_member@user:tim#...
  group:engineering#direct_member@user:frank#...
  group:engineering#intern@user:james#...
  group:engineering#intern@user:tom#...
  group:engineering#intern@user:jim#...
  group:engineering#intern@user:tim#...
  group:engineering#intern@user:frank#...
  group:engineering#allowed@user:tim#...
assertions:
  assertTrue:
    - "document:firstdoc#view@user:tom#..."
    - "document:firstdoc#view@user:sarah#..."
    - "document:firstdoc#view@user:fred#..."
    - "document:firstdoc#view@user:tim#..."
  assertFalse:
    - "document:firstdoc#view@user:james#..."
    - "document:firstdoc#view@user:jim#..."
    - "document:firstdoc#view@user:frank#..."
